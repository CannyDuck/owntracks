<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <meta name="author" content="OwnTracks.org">
        <link rel="canonical" href="http://owntracks.org/guide/topics/">
        <link rel="shortcut icon" href="../../favicon.ico">
        

	<title>Topics - OwnTracksDoc</title>

        <link href="../../css/bootstrap-3.0.3.min.css" rel="stylesheet">
        <link href="../../css/font-awesome-4.0.3.css" rel="stylesheet">
        <link rel="stylesheet" href="../../css/highlight.css">
        <link href="../../css/base.css" rel="stylesheet">

        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>

            <!-- Main title -->
            <a class="navbar-brand" href="../..">OwnTracksDoc</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            <!-- Main navigation -->
            <ul class="nav navbar-nav">
            
            
                <li >
                    <a href="../..">Intro</a>
                </li>
            
            
            
                <li class="dropdown active">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Guide <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li >
                            <a href="../what/">What it does</a>
                        </li>
                    
                        <li >
                            <a href="../how/">How it works</a>
                        </li>
                    
                        <li >
                            <a href="../ui/">User interface</a>
                        </li>
                    
                        <li >
                            <a href="../scenarios/">Scenarios</a>
                        </li>
                    
                        <li >
                            <a href="../mqtt/">MQTT</a>
                        </li>
                    
                        <li class="active">
                            <a href="./">Topics</a>
                        </li>
                    
                        <li >
                            <a href="../broker/">Broker</a>
                        </li>
                    
                        <li >
                            <a href="../clients/">Clients</a>
                        </li>
                    
                        <li >
                            <a href="../friends/">Friends</a>
                        </li>
                    
                        <li >
                            <a href="../waypoints/">Waypoints</a>
                        </li>
                    
                        <li >
                            <a href="../beacons/">iBeacons</a>
                        </li>
                    
                        <li >
                            <a href="../bridge/">Bridging</a>
                        </li>
                    
                    </ul>
                </li>
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Features <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li >
                            <a href="../../features/hosted/">Hosted</a>
                        </li>
                    
                        <li >
                            <a href="../../features/security/">Security</a>
                        </li>
                    
                        <li >
                            <a href="../../features/tid/">TID</a>
                        </li>
                    
                        <li >
                            <a href="../../features/friends/">Friends</a>
                        </li>
                    
                        <li >
                            <a href="../../features/card/">Card</a>
                        </li>
                    
                        <li >
                            <a href="../../features/waypoints/">Waypoints</a>
                        </li>
                    
                        <li >
                            <a href="../../features/beacons/">Beacons</a>
                        </li>
                    
                        <li >
                            <a href="../../features/pedometer/">Pedometer</a>
                        </li>
                    
                        <li >
                            <a href="../../features/settings/">Settings</a>
                        </li>
                    
                        <li >
                            <a href="../../features/debug/">Debugging</a>
                        </li>
                    
                    </ul>
                </li>
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">API <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li >
                            <a href="../../tech/json/">JSON</a>
                        </li>
                    
                        <li >
                            <a href="../../tech/program/">Code</a>
                        </li>
                    
                    </ul>
                </li>
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Sundry <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li >
                            <a href="../../terminology/">Terminology</a>
                        </li>
                    
                        <li >
                            <a href="../../people/">People</a>
                        </li>
                    
                        <li >
                            <a href="../../ideas/">Ideas</a>
                        </li>
                    
                        <li >
                            <a href="../../faq/">Answers</a>
                        </li>
                    
                        <li >
                            <a href="../../press/">Press</a>
                        </li>
                    
                    </ul>
                </li>
            
            
            </ul>

            <!-- Search, Navigation and Repo links -->
            <ul class="nav navbar-nav navbar-right">
                
                <li >
                    <a rel="next" href="../mqtt/">
                        <i class="fa fa-arrow-left"></i> Previous
                    </a>
                </li>
                <li >
                    <a rel="prev" href="../broker/">
                        Next <i class="fa fa-arrow-right"></i>
                    </a>
                </li>
                
                <li>
                    <a href="https://github.com/owntracks">
                        
                            <i class="fa fa-github"></i>
                        
                        GitHub
                    </a>
                </li>
                
            </ul>
        </div>
    </div>
</div>

        <div class="container">
            <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="main active"><a href="#topics">Topics</a></li>
        
            <li><a href="#topic-name-root">topic name Root</a></li>
        
            <li><a href="#device-name">Device name</a></li>
        
            <li><a href="#base-topic-name">Base topic name</a></li>
        
            <li><a href="#subscribing-to-location-messages">Subscribing to location Messages</a></li>
        
            <li><a href="#additional-topic-names">Additional topic names</a></li>
        
            <li><a href="#beacons">Beacons</a></li>
        
            <li><a href="#summary">Summary</a></li>
        
            <li><a href="#terms-used">Terms used</a></li>
        
    
    </ul>
</div></div>
            <div class="col-md-9" role="main">

<h1 id="topics">Topics</h1>
<p>You now know that <a href="../mqtt/">MQTT</a> is a messaging protocol, and that it uses
topic names to label messages.  topic names can be structured into multiple
topic levels by separating them with a forward slash (<code>/</code>). topic levels are
UTF-8 text strings, and almost any character is valid except <code>/</code>, <code>*</code>, and <code>+</code>.
The last two are used to address sets of topic names.</p>
<p>The principles during the design of the OwnTracks topic-naming scheme were</p>
<ul>
<li>human readability</li>
<li>traffic minimization</li>
<li>granular access control</li>
</ul>
<h4 id="topic-name-root">topic name Root</h4>
<p>Typically an MQTT broker hosts multiple applications. To create a separate name space
for OwnTracks we use a topic name root as the beginning of a topic name. Per default
this is <code>owntracks/</code>, but you may choose any other root (e.g. <code>peters/locations/</code>) or,
if you prefer, the empty string.</p>
<h4 id="device-name">Device name</h4>
<p>Locations are captured in OwnTracks by devices (e.g. your Smartphone). The
device name forms the second component of the topic name. In order to avoid
clashes in naming and to simplify subscription and authorization we decided to
use two topic levels</p>
<ol>
<li>The user name or identifier (e.g. <code>peter</code>)</li>
<li>The device name (e.g. <code>iPhone</code>)</li>
</ol>
<p>A typical topic name for a device would therefore be <code>peter/iPhone</code>. Other
device naming schemes are possible and transparent to OwnTracks (e.g. using
just one level <code>peters-iPhone</code> or multiple levels <code>aFamily/father/iPhone</code>), but
under any one OwnTracks name root the number of levels used for device names
have to the same.</p>
<h4 id="base-topic-name">Base topic name</h4>
<p>Combining the topic name root and the device name result in what we call <em>base
topic name</em> for each device (e.g. <code>owntracks/peter/iPhone</code>).  The devices label
their location messages with the <em>base topic name</em> when publishing to the MQTT
broker.</p>
<h4 id="subscribing-to-location-messages">Subscribing to location Messages</h4>
<p>Given the structure explained above, the topic filter you can use to subscribe to the
location messages of all devices is <code>owntracks/+/+</code> (the topic name root plus a so-called
wild card (<code>+</code>) for each level of the device name.</p>
<h4 id="additional-topic-names">Additional topic names</h4>
<p>For additional communication from and to devices, OwnTracks uses topic names relative
to the base topic name.</p>
<p>Devices listen to the relative topic name <code>cmd</code> for commands you can publish to
OwnTracks devices (i.e. <code>owntracks/peter/iPhone/cmd</code>). For example, if
authorized, you could request a location update from a friend's device by
publishing an <a href="../../tech/json/">appropriate payload</a> to said topic.</p>
<p>The output of specific OwnTracks commands is published by the device to the
relative topic names <code>step</code>, <code>dump</code>, etc.</p>
<p>In addition, devices subscribe to the relative topic name <code>info</code> for information about 
other devices. Messages published with the relative topic name <code>info</code>
(e.g. <code>owntracks/peter/iPhone/info</code>) contain a <em>card</em> payload -- the name and
avatar of a user with which authorized users can identify, say, Peter within their OwnTracks app.</p>
<p>Devices publish their <a href="../waypoints/">waypoints</a> to the relative topic name
<code>waypoint</code> and the corresponding events the transition into or out of a
waypoint triggers, to the relative topic name <code>event</code>.</p>
<h4 id="beacons">Beacons</h4>
<p>FIXME: Christoph</p>
<h4 id="summary">Summary</h4>
<p>A device (named <code>peter/iPhone</code> in this example) is connected to an <a href="../broker/">MQTT
Broker</a> with the OwnTracks name Root <code>owntracks</code>. It publishes
location messages labeled with the topic name <code>owntracks/peter/iPhone</code>. The
same device publishes <a href="../waypoints/">waypoints</a> labeled as
<code>owntracks/peter/iPhone/waypoint</code>and publishes to
<code>owntracks/peter/iPhone/event</code> when entering or leaving a waypoint (i.e. a monitored region).</p>
<p>The same device subscribes to <code>owntracks/+/+</code> to receive location messages of all 
other devices it is authorized for which are connected to the same MQTT broker.
In addition, the device may listen to <code>owntracks/+/+/event</code>if the user of the devices
wants to be informed about other users entering or leaving monitored regions. Subscribing
to <code>owntracks/+/+/info</code>gives the device access to additional information about the other
devices.</p>
<p>If a device's owner allows other users to ad-hoc request messages from his device,
the device will subscribe to <code>owntracks/peter/iPhone/cmd</code> as well, and it will listen for OwnTracks
commands; responses to these commands will be published and labeled <code>owntracks/peter/iPhone/dump</code>,
<code>owntracks/peter/iPhone/step</code>, etc.</p>
<p>A full set of supported topic names and expected payloads is documented in <a href="../../tech/json/">our JSON API</a>.</p>
<h4 id="terms-used">Terms used</h4>
<ul>
<li>topic name</li>
<li>OwnTracks topic name root</li>
<li>OwnTracks device name</li>
<li>OwnTracks base topic name</li>
<li>relative topic names</li>
<li>OwnTracks device</li>
<li>OwnTracks user</li>
<li>OwnTracks command</li>
</ul></div>
        </div>

	<footer class="col-md-12">
		<hr>
		
		<p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</p>
	</footer>

        

        <script src="../../js/jquery-1.10.2.min.js"></script>
        <script src="../../js/bootstrap-3.0.3.min.js"></script>
        <script src="../../js/highlight.pack.js"></script>
        <script src="../../js/base.js"></script>
    </body>
</html>