<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>JSON - OwnTracks Booklet</title>
  

  <link rel="shortcut icon" href="../../favicon.ico">
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../../css/highlight.css">
  <link href="../../css/custom.css" rel="stylesheet">

  <script src="../../js/jquery-2.1.1.min.js"></script>
  <script src="../../js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="../../js/highlight.pack.js"></script>
  <script src="../../js/theme.js"></script> 

  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> OwnTracks Booklet</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        <ul class="current">
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="../..">Intro</a>
        
    </li>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Guide</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../guide/whathow/">What it does</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../guide/ui/">User interface</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../guide/scenarios/">Scenarios</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../http/">HTTP mode</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../guide/mqtt/">MQTT</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../guide/topics/">Topics</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../guide/broker/">Broker</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../guide/apps/">Apps</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../guide/clients/">Clients</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../guide/friends/">Friends</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../guide/waypoints/">Waypoints</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../guide/beacons/">Beacons</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../guide/bridge/">Bridging</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Features</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../features/security/">Security</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../features/tls/">TLS</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../features/tlscert/">TLS client</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../features/location/">Location</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../features/tid/">TID</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../features/friends/">Friends</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../features/card/">Card</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../features/waypoints/">Waypoints</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../features/beacons/">Beacons</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../features/pedometer/">Pedometer</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../features/settings/">Settings</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../features/comparison/">Comparison</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../features/android/">Android</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../features/ios/">iOS</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../features/encrypt/">Encryption</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../features/remoteconfig/">Remoteconfig</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../features/debug/">Debugging</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>API</span></li>

        
            
    <li class="toctree-l1 current">
        <a class="current" href="./">JSON</a>
        
            <ul>
            
                <li class="toctree-l3"><a href="#json">JSON</a></li>
                
            
                <li class="toctree-l3"><a href="#topics">Topics</a></li>
                
            
                <li class="toctree-l3"><a href="#_typelocation">_type=location</a></li>
                
                    <li><a class="toctree-l4" href="#greenwich">Greenwich</a></li>
                
            
                <li class="toctree-l3"><a href="#_typelwt">_type=lwt</a></li>
                
            
                <li class="toctree-l3"><a href="#_typewaypoint">_type=waypoint</a></li>
                
            
                <li class="toctree-l3"><a href="#_typetransition">_type=transition</a></li>
                
            
                <li class="toctree-l3"><a href="#_typeconfiguration">_type=configuration</a></li>
                
                    <li><a class="toctree-l4" href="#notes">Notes</a></li>
                
            
                <li class="toctree-l3"><a href="#_typebeacon">_type=beacon</a></li>
                
            
                <li class="toctree-l3"><a href="#_typecmd">_type=cmd</a></li>
                
            
                <li class="toctree-l3"><a href="#_typesteps">_type=steps</a></li>
                
            
                <li class="toctree-l3"><a href="#_typecard">_type=card</a></li>
                
            
                <li class="toctree-l3"><a href="#_typewaypoints">_type=waypoints</a></li>
                
            
                <li class="toctree-l3"><a href="#_typeencrypted">_type=encrypted</a></li>
                
            
            </ul>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../mqtt/">MQTT</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../qr/">QR</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../program/">Code</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Sundry</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../terminology/">Terminology</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../clients/recorder/">Docker</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../privacy/">Privacy</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../people/">People</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../ideas/">Ideas</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../faq/">Answers</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../press/">Press</a>
        
    </li>

        
    </ul>
<li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">OwnTracks Booklet</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>API &raquo;</li>
        
      
    
    <li>JSON</li>
    <li class="wy-breadcrumbs-aside">
      
        
          <a href="https://github.com/owntracks" class="icon icon-github"> Edit on GitHub</a>
        
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h2 id="json">JSON</h2>
<p>OwnTracks publishes its message payloads in <a href="http://www.json.org">JSON</a> format. The different payload types are identified by a <code>_type</code> element. Depending on the app platform, different payload types are supported. </p>
<table>
<thead>
<tr>
<th><code>_type</code></th>
<th>iOS</th>
<th>Android</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>location</code></td>
<td>Y</td>
<td>Y</td>
</tr>
<tr>
<td><code>lwt</code></td>
<td>Y</td>
<td>Y</td>
</tr>
<tr>
<td><code>waypoint</code></td>
<td>Y</td>
<td>Y</td>
</tr>
<tr>
<td><code>transition</code></td>
<td>Y</td>
<td>Y</td>
</tr>
<tr>
<td><code>beacon</code></td>
<td>Y</td>
<td>N</td>
</tr>
<tr>
<td><code>cmd</code></td>
<td>Y</td>
<td>Y</td>
</tr>
<tr>
<td><code>steps</code></td>
<td>Y</td>
<td>N</td>
</tr>
<tr>
<td><code>configuration</code></td>
<td>Y</td>
<td>Y</td>
</tr>
<tr>
<td><code>card</code></td>
<td>Y</td>
<td>Y</td>
</tr>
<tr>
<td><code>waypoints</code></td>
<td>Y</td>
<td></td>
</tr>
<tr>
<td><code>encrypted</code></td>
<td>Y</td>
<td>Y</td>
</tr>
</tbody>
</table>
<h2 id="topics">Topics</h2>
<p>In MQTT mode the apps publish to:</p>
<ul>
<li><code>owntracks/user/device</code> with <code>_type=location</code> for location updates, and with <code>_type=lwt</code></li>
<li><code>owntracks/user/device/cmd</code> with <code>_type=cmd</code>      for remote commands</li>
<li><code>owntracks/user/device/event</code> with <code>_type=transition</code> for enter/leave events</li>
</ul>
<p>Apps subscribe to:</p>
<ul>
<li><code>owntracks/user/device/cmd</code> if remote commands are enabled</li>
<li><code>owntracks/+/+</code> for seeing other user's locations, depending on broker ACL</li>
<li><code>owntracks/+/+/event</code> (singular) for transition messages (<code>enter</code>/<code>leave</code>)</li>
<li><code>owntracks/+/+/waypoint</code>  (singular) for Waypoint definitions/modifications</li>
<li><code>owntracks/+/+/info</code>  for obtaining <a href="../../features/card/">cards</a>.</li>
</ul>
<p>In addition, the iOS app publishes to:</p>
<ul>
<li><code>owntracks/user/device/step</code> to report step counter</li>
<li><code>owntracks/user/device/beacon</code> for beacon ranging</li>
<li><code>owntracks/user/device/dump</code> for config dumps</li>
</ul>
<p>In HTTP mode the apps POST their data to a single endpoint you configure. That endpoint needs to distinguish which type of payload it is receiving.</p>
<h2 id="_typelocation"><code>_type=location</code></h2>
<p>This location object describes the location of the device that published it. <strong>Heads up: as from Android version 0.5.11 and from iOS version 8.0 numeric types are real numeric (<code>float</code>, <code>int</code>, boolean <code>true</code>/<code>false</code>) and no longer strings.</strong></p>
<pre><code class="json">{
    &quot;_type&quot; : &quot;location&quot;,        
    &quot;acc&quot;   : 75,              
    &quot;alt&quot;   : 13,
    &quot;batt&quot;  : nnn,              
    &quot;cog&quot;   : 270,
    &quot;desc&quot;  : &quot;sssss&quot;,
    &quot;event&quot; : &quot;sssss&quot;,
    &quot;lat&quot;   : x.xxxxxx,       
    &quot;lon&quot;   : y.yyyyyy,        
    &quot;rad&quot;   : nnn, 
    &quot;t&quot;     : &quot;x&quot;,
    &quot;tid&quot;   : &quot;YY&quot;,
    &quot;tst&quot;   : 1376715317,      
    &quot;vacc&quot;  : 10,
    &quot;vel&quot;   : 54,
    &quot;p&quot;     : nnn
}
</code></pre>

<ul>
<li><code>acc</code> is accuracy of the reported location in meters without unit (integer). iOS adds this element only if it &gt;= 0.</li>
<li><code>alt</code> is the altitude measured in meters above sea level (<em>Optional</em>, integer). iOS adds this element only if it &gt;= 0.</li>
<li><code>batt</code> is the device's battery level in percent (integer)</li>
<li><code>cog</code> is the heading (course over ground) in degrees, 0 = North (<em>Optional</em>, integer). iOS adds this element only if it &gt;= 0.. iOS adds this element only if it &gt;= 0.</li>
<li><code>desc</code> is the description of a <a href="../../features/waypoints/">waypoint</a></li>
<li><code>event</code> is one of <code>"enter"</code> or <code>"leave"</code> and tells if the app is entering or leaving a geofence </li>
<li><code>lat</code> is latitude as decimal, represented as a floating point number</li>
<li><code>lon</code> is longitude as decimal, represented as a floating point number</li>
<li><code>rad</code> is the radius in meters around around the geo-fence when entering/leaving a geofence (integer)</li>
<li><code>t</code> is the trigger for the publish x = <ul>
<li>"p" ping, issued randomly by background task. Note, that the <code>tst</code> in a ping is that of the <a href="https://github.com/owntracks/ios/issues/197">last location reported by iOS</a>, so this may look like a duplicate.</li>
<li>"c" circular region enter/leave event </li>
<li>"b" beacon region enter/leave event</li>
<li>"r" response to a "reportLocation" request</li>
<li>"u" manual publish requested by the user</li>
<li>"t" timer based publish in move move</li>
<li>"a" or missing <code>t</code> indicates automatic location update</li>
</ul>
</li>
<li><code>tid</code> is a configurable tracker-ID which is used by the iOS auto-faces feature to display, say, initials of a user. If it isn't explicitly configured, it defaults to the last two characters of the device's publish topic. </li>
<li><code>tst</code> is a UNIX <a href="http://en.wikipedia.org/wiki/Unix_time">epoch timestamp</a> of the event as it occurs which may be different from the time it is published (integer, seconds).</li>
<li><code>vacc</code> is the vertical accuracy of the reported altitude in meters (<em>Optional</em>, integer). iOS adds this element only if it &gt;= 0.</li>
<li><code>vel</code> is the velocity (speed) in km/h (<em>Optional</em>, integer). iOS adds this element only if it &gt;= 0.</li>
<li><code>p</code> is barometric pressure in kPa (kilo Pascal) (iOS &gt; 8.1.1 only with <em>Extended data</em> enabled)</li>
</ul>
<p>(The iOS device can be configured to produce or not produce fields marked as <em>optional</em> with the Extended Data setting.)</p>
<p>Notes:
* A publish with of <code>"_type": "location"</code> with a <code>"b"</code> trigger is sent when an iOS device enters or leaves a beacon in addition to a <code>"_type": "transition"</code>: if somebody leaves and enters his home without having left the radius of detection for significant changes, a subscriber to his main topic would otherwise not get notified of any location change although beacon or circular region enter and leave transitions were generated.</p>
<h3 id="greenwich">Greenwich</h3>
<p>The OwnTracks-edition of the <a href="http://www.choral.it/greenwich&amp;menu2=795">Choral Greenwich</a> device reports the following additional elements in a <code>_type=location</code> message:</p>
<pre><code class="json">{
    &quot;_type&quot;: &quot;location&quot;,
    &quot;alt&quot;: 160,
    &quot;cog&quot;: 0,
    &quot;dist&quot;: 189,
    &quot;trip&quot;: 279122,
    &quot;lat&quot;: xx.xxxxxx,
    &quot;lon&quot;: y.yyyyyy,
    &quot;vel&quot;: 12,
    &quot;t&quot;: &quot;t&quot;,
    &quot;tst&quot;: 1406803894
}
</code></pre>

<ul>
<li><code>alt</code> is altitude in meters. (<em>Optional</em>)</li>
<li><code>batt</code> is the external battery voltage. (<em>Optional</em>)</li>
<li><code>cog</code> is the course over ground (heading) in degrees. (<em>Optional</em>)</li>
<li><code>dist</code> is the distance travelled in meters since the last location publish. (<em>Optional</em>)</li>
<li><code>trip</code> is the distance travelled in meters since the last reboot. (<em>Optional</em>)</li>
<li><code>vel</code> is the speed (velocity) in km/h. (<em>Optional</em>)</li>
<li><code>t</code> is the trigger of the published message:</li>
<li><code>f</code> first publish after reboot</li>
<li><code>m</code> for manually requested locations (e.g. by publishing to <code>/cmd</code>)</li>
<li><code>t</code> (time) for location published because device is moving.</li>
<li><code>T</code> (time) for location published because of time passed (<code>maxInterval</code>); device is stationary</li>
<li><code>k</code> When transitioning from <em>move</em> to <em>stationary</em> an additional publish is sent marked with trigger <code>k</code> (park)</li>
<li><code>v</code> When transitioning from <em>stationary</em> to <em>move</em> additional publish is sent marked with trigger <code>v</code> (mo-v-e)</li>
<li><code>l</code> When device looses GPS fix, an additional publish is sent to transmit the last known position</li>
<li><code>L</code> last position before gracefull shutdown</li>
</ul>
<p>(The device can be configured to produce or not produce fields marked as <em>optional</em>.)</p>
<h2 id="_typelwt"><code>_type=lwt</code></h2>
<p>A <em>last will and testament</em> is published automatically by the MQTT broker when it looses contact with the app. This typically looks like this:</p>
<pre><code class="json">{
    &quot;_type&quot;:&quot;lwt&quot;,
    &quot;tst&quot;: 1380738247
}
</code></pre>

<p>The timestamp is the Unix epoch time at which the app first connected (and <em>not</em> the time at which the LWT was published).</p>
<h2 id="_typewaypoint"><code>_type=waypoint</code></h2>
<p>Waypoints denote specific geographical locations that you want to keep track of. You define a waypoint on the OwnTracks device, and OwnTracks publishes this waypoint (if the waypoint is marked <code>shared</code>). OwnTracks also monitors these waypoints and will publish a transition event (<code>_type: transition</code>) when entering or leaving the region. Note, that a waypoint may also define a <a href="../../features/beacons/">Beacon</a>.</p>
<pre><code class="json">{
    &quot;_type&quot;  : &quot;waypoint&quot;,
    &quot;desc&quot;   : &quot;Free text entered on device&quot;,
    &quot;lat&quot;    : x.xxxxxx,       
    &quot;lon&quot;    : y.yyyyyy,        
    &quot;rad&quot;    : xxx,
    &quot;tst&quot;    : nnnnn,
    &quot;shared&quot; : true,
    &quot;tid&quot;    : &quot;XX&quot;,
    &quot;uuid&quot;   : &quot;YYYYYYYYYYYYYYYYY&quot;,
    &quot;major&quot;  : 17,
    &quot;minor&quot;  : 1
}
</code></pre>

<ul>
<li><code>shared</code> location messages of shared waypoints contain a desc and event attribute. Not shared ones contain an event attribute only</li>
<li><code>tst</code> is the timestamp of waypoint <em>creation</em> even if it was subsequently modified by the user. (See <a href="../../features/waypoints/">Waypoints</a>.) It is copied into the <code>wtst</code> of the transition event (<code>type: transition</code>) when an event pertaining to this waypoint fires.</li>
<li>In iOS version &gt;= 9.1.0 and in Android version &gt;= 0.6.0 the last three elements (uuid, major, and minor) are used to configure Beacon waypoints instead of encoding these values into the <code>desc</code> element.</li>
</ul>
<p>Waypoints are published non-retained because the second waypoint would overwrite the first: a client would only get the last one which makes no sense. Your application will typically store waypoints to some kind of persistent storage.</p>
<h2 id="_typetransition"><code>_type=transition</code></h2>
<p>A transition into or out of a previously configured waypoint is effected by publishing a <em>transition</em> to the <code>../event</code> subtopic using MQTT. (In HTTP mode the payload is published to the configured endpoint.) In addition to the coordinates where the event fired (<code>lat</code>, <code>lon</code>, and <code>acc</code> of these), the message contains the timestamp of the waypoint creation (<code>wtst</code>) as well as the <code>event</code> (which can be either <code>enter</code> or <code>leave</code>) and, in the case of a shared waypoint, it's description in <code>desc</code>. Transition messages are published with <code>retain=0</code>.</p>
<pre><code class="json">{
  &quot;_type&quot;: &quot;transition&quot;,
  &quot;wtst&quot;: 1425042603,           // time of waypoint creation
  &quot;lat&quot;: 12.34,                 // transition coordinates i.e. &quot;here&quot;
  &quot;lon&quot;: 44.5,
  &quot;tst&quot;: 1427634603,            // timestamp of transition (e.g. &quot;now&quot;)
  &quot;acc&quot;: 130,                   // accuracy of lat, lon
  &quot;tid&quot;: &quot;JP&quot;,
  &quot;event&quot;: &quot;enter&quot;,
  &quot;desc&quot;: &quot;my Indian restaurant&quot;,
  &quot;t&quot;: &quot;b&quot;          // trigger (&quot;c&quot; -default- for circular regions, &quot;b&quot; for beacons, &quot;w&quot; for WiFi (Android only))
}
</code></pre>

<p>A transition event published as a result of a Beacon movement will have a <code>"t" : "b"</code> associated with it.</p>
<h2 id="_typeconfiguration"><code>_type=configuration</code></h2>
<p>The device configuration can be imported and exported as JSON. The exported configuration can contain an array of waypoints that are defined on the device. </p>
<pre><code class="json">{
    &quot;_type&quot;: &quot;configuration&quot;,
    &quot;mode&quot;: 0,
    &quot;locked&quot;: false,
    &quot;deviceId&quot;: &quot;phone&quot;,
    &quot;clientId&quot;: &quot;jane-phone&quot;,
    &quot;trackerId&quot;: &quot;xx&quot;,
    &quot;subTopic&quot;: &quot;owntracks/#&quot;,
    &quot;pubTopicBase&quot;: &quot;owntracks/jane/phone&quot;,
    &quot;host&quot;: &quot;broker.my.net&quot;,
    &quot;username&quot;: &quot;jane&quot;,
    &quot;password&quot;: &quot;secr3t&quot;,
    &quot;willTopic&quot;: &quot;&quot;,
    &quot;subQos&quot;: 1,
    &quot;pubQos&quot;: 2,
    &quot;pubInterval&quot; : 30,
    &quot;port&quot;: 8883,
    &quot;keepalive&quot;: 60,
    &quot;willQos&quot;: 1,
    &quot;pubRetain&quot;: true,
    &quot;tls&quot;: true,
    &quot;tlsCrtPath&quot; : &quot;/foo/bar&quot;,
    &quot;auth&quot;: true,
    &quot;cleanSession&quot;: false,
    &quot;willRetain&quot;: false,
    &quot;locatorDisplacement&quot;: 200,
    &quot;locatorInterval&quot;: 180,
    &quot;locatorAccuracyBackground&quot; : 2,
    &quot;locatorAccuracyForeground&quot; : 0,
    &quot;messaging&quot;: true,
    &quot;monitoring&quot;: 1,
    &quot;ranging&quot;: &quot;&quot;,
    &quot;positions&quot;: 50,
    &quot;connectionAdvancedMode&quot; : false,
    &quot;autostartOnBoot&quot; : false,
    &quot;pubIncludeBattery&quot; : false,
    &quot;sub&quot; : false,
    &quot;pub&quot; : false,
    &quot;updateAddressBook&quot; : false,
    &quot;notification&quot; : false,
    &quot;notificationLocation&quot; : false,
    &quot;notificationGeocoder&quot; : false,
    &quot;notificationTickerOnPublish&quot; : false,
    &quot;notificationTickerOnGeofenceTransition&quot; : false,
    &quot;remoteCommandReportLocation&quot; : false,
    &quot;remoteCommandDump&quot; : false,
    &quot;cmd&quot; : false,
    &quot;allowRemoteLocation&quot; : false,
    &quot;extendedData&quot; : false,
    &quot;remoteConfiguration&quot; : false,
    &quot;usepolicy&quot; : false,
    &quot;policymode&quot; : 0,
    &quot;allowinvalidcerts&quot; : false,
    &quot;validatedomainname&quot; : false,
    &quot;validatecertificatechain&quot; : false,
    &quot;servercer&quot; : &quot;&quot;,
    &quot;clientpkcs&quot; : &quot;&quot;,
    &quot;passphrase&quot; : &quot;&quot;,
    &quot;waypoints&quot; : [
                    { &quot;_type&quot; : &quot;waypoint&quot;,
                      &quot;tst&quot;: nnnnnnnnnn,
                      &quot;lat&quot;: nn.nnn,
                      &quot;lon&quot;: nn.nnn,
                      &quot;rad&quot;: nnn,
                      &quot;shared&quot;: true,
                      &quot;desc&quot; : &quot;blabla&quot;
                    } 
                  ]
}
</code></pre>

<ul>
<li><code>mode</code>                    0 == <em>Private</em> mode, 2 == <em>Public</em> mode, 3 == <em>HTTP</em> mode</li>
<li><code>locked</code>                  if set to true, locks settings screen on device for editing. View only. Default = false. Can only be set via <code>.otrc</code> import.</li>
<li><code>subTopic</code>                                    is what the apps subscribe to</li>
<li><code>pubTopicBase</code>                                is the prefix under which the apps will publish</li>
<li><code>username</code></li>
<li><code>password</code></li>
<li><code>deviceId</code></li>
<li><code>tid</code>                      is a configurable tracker-ID which is used by the iOS auto-faces feature to display, say, initials of a user. If it isn't explicitly configured, it defaults to the last two characters of the device's publish topic. </li>
<li><code>willTopic</code></li>
<li><code>subQos</code></li>
<li><code>pubQos</code></li>
<li><code>willQos</code></li>
<li><code>pubRetain</code></li>
<li><code>tlsCrtPath</code>                  not in iOS</li>
<li><code>cleanSession</code></li>
<li><code>willRetain</code></li>
<li><code>locatorDisplacement</code>             in meters</li>
<li><code>locatorInterval</code>             in seconds</li>
<li><code>locatorAccuracyBackground</code>           0 == high power, 1 == balanced power, 2 == low power, 3 == no power</li>
<li><code>locatorAccuracyForeground</code>           0 == high power, 1 == balanced power, 2 == low power, 3 == no power</li>
<li><code>monitoring</code>                  iOS only, set in UI. The four modes are: Quiet (-1), Manual (0), Significant (1), and Move (2)</li>
<li><code>ranging</code>                 iOS only, set in UI</li>
<li><code>positions</code>                   iOS only, number of positions to keep and display</li>
<li><code>autostartOnBoot</code>             Android only</li>
<li><code>pubIncludeBattery</code>               Android only, in iOS alway on</li>
<li><code>sub</code>                     Android only, subscription enabled for contacts, in iOS always subscribed</li>
<li><code>pub</code>                     Android only, auto publish, in iOS controlled by <code>monitoring</code></li>
<li><code>updateAddressBook</code></li>
<li><code>notification</code>                Android only, show notifications</li>
<li><code>notificationLocation</code>            Android only, show last reported location in notification, off in iOS</li>
<li><code>notificationGeocoder</code>            Android only, resolve location in notification to address, in iOS only resolved when in show details</li>
<li><code>notificationTickerOnPublish</code>         Android only, show a ticker on successful publishes, always off in iOS", </li>
<li><code>notificationTickerOnGeofenceTransition</code>  Android only, show a ticker when the devices enters or leaves a geofence, always on in iOS", </li>
<li><code>remoteCommandReportLocation</code>         Android only, respond to reportLocation remote command</li>
<li><code>remoteCommandDump</code>               Android only, respond to dump remote command</li>
<li><code>cmd</code>                     iOS only, respond to remote commands</li>
<li><code>allowRemoteLocation</code>             iOS only, respond to remote location request even if monitoring mode is set to manual</li>
<li><code>extendedData</code>                iOS only, add altitude, vertical accuracy, velocity and course over ground to published data</li>
<li><code>remoteConfiguration</code>             Android only, respond to remote configuration messages</li>
<li><code>usepolicy</code>                   iOS only, use user defined security policy</li>
<li><code>allowinvalidcerts</code>               iOS only, allow self signed certificates in user defined security policy</li>
<li><code>validatedomainname</code>              iOS only, validate domain main during TLS handshake</li>
<li><code>validatecertificatechain</code>            iOS only, validate the whole certificate chain or just the server certificate</li>
<li><code>policymode</code>                  iOS only, <ul>
<li>0 = Do not used pinned certificates to validate servers.</li>
<li>1 = Validate host certificates against public keys of pinned certificates.</li>
<li>2 = Validate host certificates against pinned certificates.</li>
</ul>
</li>
<li><code>servercer</code>                   iOS only, blank separated list of certificate file names in DER format, or empty</li>
<li><code>clientpkcs</code>                  iOS only, name of the client pkcs12 file,or empty </li>
<li><code>passphrase</code>                  iOS only, passphrase for client pkcs12 file </li>
</ul>
<h4 id="notes">Notes</h4>
<ul>
<li>Imagine you are operating an OwnTracks backend for e.g. your family, and you want to avoid your family members accidentally switching modes or modifying settings locally on the device. You can export their configuration, add a <code>locked: true</code> to it and re-import it onto the iOS device. The settings will then be visible, but cannot be changed.</li>
</ul>
<h2 id="_typebeacon"><code>_type=beacon</code></h2>
<p>These messages are published when beacon ranging (iOS only) is enabled. Be advised that beacon ranging publishes a lot of messages and has a strong impact on battery life.</p>
<pre><code class="json">{
        &quot;_type&quot;:&quot;beacon&quot;,
        &quot;uuid&quot;:&quot;CA271EAE-5FA8-4E80-8F08-2A302A95A959&quot;,
        &quot;major&quot;:1,
        &quot;minor&quot;:1,
        &quot;tst&quot;: 1399028969,
        &quot;acc&quot;:n,
        &quot;rssi&quot;:n,
        &quot;prox&quot;:n,
}
</code></pre>

<ul>
<li><code>acc</code> The accuracy of the proximity value, measured in meters from the beacon.</li>
<li><code>rssi</code>    The received signal strength of the beacon, measured in decibels. The theoretical relationship between RSSI and distance is something like this: <code>RSSI[dbm] = −(10n log10(d) − A)</code> where d is the distance and A is the offset which is the measured RSSI 1 meter point away from the Bluetooth Low Energy device.</li>
<li><code>prox</code>    The relative distance to the beacon where n indicates<ul>
<li>0 = the proximity of the beacon could not be determined.</li>
<li>1 = the beacon is in the user’s immediate vicinity.</li>
<li>2 = the beacon is relatively close to the user.</li>
<li>3 = the beacon is far away."</li>
</ul>
</li>
</ul>
<h2 id="_typecmd"><code>_type=cmd</code></h2>
<pre><code class="json">{&quot;_type&quot;:&quot;cmd&quot;,&quot;action&quot;:&quot;reportLocation&quot;}
{&quot;_type&quot;:&quot;cmd&quot;,&quot;action&quot;:&quot;reportSteps&quot;}
{&quot;_type&quot;:&quot;cmd&quot;,&quot;action&quot;:&quot;dump&quot;}
{&quot;_type&quot;:&quot;cmd&quot;,&quot;action&quot;:&quot;waypoints&quot;}
{&quot;_type&quot;:&quot;cmd&quot;,&quot;action&quot;:&quot;setWaypoints&quot;,&quot;waypoints&quot;:[...]}
{&quot;_type&quot;:&quot;cmd&quot;,&quot;action&quot;:&quot;action&quot;,&quot;content&quot;:&quot;Backend maintenance scheduled for tonight\n\nhttp://support.owntracks.org&quot;}
{&quot;_type&quot;:&quot;cmd&quot;,&quot;action&quot;:&quot;action&quot;,&quot;content&quot;:&quot;&lt;a href='http://support.owntracks.org'&gt;Backend Maintenance tonight&lt;/a&gt;&quot;}
{&quot;_type&quot;:&quot;cmd&quot;,&quot;action&quot;:&quot;action&quot;,&quot;url&quot;:&quot;http://support.owntracks.org&quot;}
</code></pre>

<ul>
<li><code>action</code>      action to be performed by the device<ul>
<li><code>reportSteps</code> reports steps walked on iPhone 5s devices. <br>
  You may add "from":<em>timestamp</em> and/or "to":<em>timestamp</em>" 
  which defaults to current time, from defaults to current date 00:00 am
  (see <a href="../../features/pedometer/">Pedometer</a>).</li>
<li><code>reportLocation</code> triggers the publish of the current location</li>
<li><code>dump</code> triggers the publish of a configuration message</li>
<li><code>setWaypoints</code> configures new waypoints. (iOS only; <a href="../../features/remoteconfig/">details</a> )</li>
<li><code>waypoints</code> triggers a publish of all waypoints configured on the device. These are published in <code>.otrw</code> format to the <code>../waypoints</code> topic.</li>
<li><code>action</code> inserts an additional 'Featured Content' tab in the UI.</li>
<li>If <code>"url"</code> is specified, the URL is opened in a full screen web view within the app. </li>
<li>If <code>"url"</code> is not specified</li>
<li>The text in <code>"content"</code> is displayed. Links embedded in the text are operational.  If <code>"content"</code> is HTML, it is rendered.</li>
<li>Send <code>"action":"action"</code> without <code>"content"</code> and without <code>"url"</code> to remove the extra tab.</li>
<li>If <code>"notify"</code> is in the payload, it is a string which will be used as notification in the UI</li>
<li>If the optional <code>"extern"</code> boolean is <code>true</code> a click on the notification will launch an external Web browser; <code>false</code> (the default) opens the <code>url</code> in a Webview within the OwnTracks app.</li>
</ul>
</li>
</ul>
<h2 id="_typesteps"><code>_type=steps</code></h2>
<pre><code class="json">{&quot;_type&quot;:&quot;steps&quot;,&quot;tst&quot;:1400455130,&quot;steps&quot;:1234,&quot;from&quot;:1400455130,&quot;to&quot;:1400458000}
</code></pre>

<ul>
<li><code>tst</code>         timestamp of the request</li>
<li><code>steps</code>   the number of steps walked with the device in the specfied time period or
                -1 if device does not support step counting or specified time period
                is invalid</li>
<li><code>from</code>        effective start of time period</li>
<li><code>to</code>          effective end of time period</li>
</ul>
<h2 id="_typecard"><code>_type=card</code></h2>
<p>As described in <a href="../../features/card/">Card</a>, apps read retained messages of <code>_type=card</code> on <code>owntracks/+/+/info</code> to find the <em>name</em> and avatar (<em>face</em>) of a user.</p>
<pre><code class="json">{
  &quot;_type&quot;: &quot;card&quot;,
  &quot;name&quot;: &quot;Jane Jolie&quot;
  &quot;face&quot;: &quot;iV1CFEVkMhmCIKBUKh3 ... ghAAAAABJRU5ErkJggg==&quot;,
}
</code></pre>

<p>The <code>name</code> element contains a name which is displayed by the apps to identify a user, and <code>face</code> contains the base64-encoded PNG image (40x40 px) which is displayed instead of a <a href="../../features/tid/">TID</a>.</p>
<h2 id="_typewaypoints"><code>_type=waypoints</code></h2>
<p>(currently iOS only)
The app can export a list of configured waypoints (separate from the configuration) in order to share these, for example. Similarly, the app can import a list of waypoints, merging them into the current list, from a JSON file with <code>.otrw</code> extension. The list of waypoints looks like this.</p>
<pre><code class="json">{
    &quot;_type&quot;: &quot;waypoints&quot;,
    &quot;_creator&quot;: &quot;OTwpDraw&quot;,
    &quot;waypoints&quot;: [
        {
            &quot;_type&quot;: &quot;waypoint&quot;,
            &quot;tst&quot;: 1433598071,
            &quot;lat&quot;: 47.580231298,
            &quot;lon&quot;: 9.525146484,
            &quot;rad&quot;: 25186,
            &quot;desc&quot;: &quot;I went swimming here&quot;
        },
        {
            &quot;_type&quot;: &quot;waypoint&quot;,
            &quot;tst&quot;: 1430398091,
            &quot;lat&quot;: 46.517295754,
            &quot;lon&quot;: 9.871215820,
            &quot;rad&quot;: 500,
            &quot;desc&quot;: &quot;Cheese fondue&quot;
        }
    ]
}
</code></pre>

<p>Note that <code>_type=waypoints</code> is <em>plural</em>.</p>
<h2 id="_typeencrypted"><code>_type=encrypted</code></h2>
<p>This payload type contains a single <code>data</code> element with the original JSON object <code>_type</code> (e.g. <code>location</code>, <code>beacon</code>, etc.) <a href="../../features/encrypt/">encrypted payload</a> in it.</p>
<pre><code class="json">{
  &quot;_type&quot;: &quot;encrypted&quot;,
  &quot;data&quot;: &quot;1Vu7Owp ... W4lMnh28FB+el22GsCrlnggvEcp4H8GR9iKJdi1qfwkejYpzrQ+491Mwunjg=&quot;
}
</code></pre>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../mqtt/" class="btn btn-neutral float-right" title="MQTT"/>Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../../features/debug/" class="btn btn-neutral" title="Debugging"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
    <!-- Copyright etc -->
    </p>
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
	  
        </div>
      </div>

    </section>

  </div>

<div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a class="icon icon-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="../../features/debug/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../mqtt/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>

</body>
</html>
