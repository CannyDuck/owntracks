<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Location - OwnTracks Booklet</title>
  

  <link rel="shortcut icon" href="../../favicon.ico">
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../../css/highlight.css">
  <link href="../../css/custom.css" rel="stylesheet">

  <script src="../../js/jquery-2.1.1.min.js"></script>
  <script src="../../js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="../../js/highlight.pack.js"></script>
  <script src="../../js/theme.js"></script> 

  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> OwnTracks Booklet</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        <ul class="current">
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="../..">Intro</a>
        
    </li>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Guide</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../guide/whathow/">What it does</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../guide/ui/">User interface</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../guide/scenarios/">Scenarios</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../guide/mqtt/">MQTT</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../guide/topics/">Topics</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../guide/broker/">Broker</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../guide/apps/">Apps</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../guide/clients/">Clients</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../guide/friends/">Friends</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../guide/waypoints/">Waypoints</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../guide/beacons/">Beacons</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../guide/bridge/">Bridging</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Features</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../hosted/">Hosted</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../security/">Security</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../tls/">TLS</a>
        
    </li>

        
            
    <li class="toctree-l1 current">
        <a class="current" href="./">Location</a>
        
            <ul>
            
                <li class="toctree-l3"><a href="#android">Android</a></li>
                
            
                <li class="toctree-l3"><a href="#ios">iOS</a></li>
                
                    <li><a class="toctree-l4" href="#move-mode">MOVE mode</a></li>
                
                    <li><a class="toctree-l4" href="#significant-location-change-mode">SIGNIFICANT LOCATION CHANGE mode</a></li>
                
                    <li><a class="toctree-l4" href="#manual-mode">MANUAL mode</a></li>
                
                    <li><a class="toctree-l4" href="#region-monitoring">REGION monitoring</a></li>
                
                    <li><a class="toctree-l4" href="#ibeacon-monitoring">iBeacon monitoring</a></li>
                
            
            </ul>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../tid/">TID</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../friends/">Friends</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../card/">Card</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../waypoints/">Waypoints</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../beacons/">Beacons</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../pedometer/">Pedometer</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../settings/">Settings</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../comparison/">Comparison</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../android/">Android</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../ios/">iOS</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../remoteconfig/">Remoteconfig</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../debug/">Debugging</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>API</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../tech/json/">JSON</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../tech/program/">Code</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Sundry</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../terminology/">Terminology</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../privacy/">Privacy</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../people/">People</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../ideas/">Ideas</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../faq/">Answers</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../press/">Press</a>
        
    </li>

        
    </ul>
<li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">OwnTracks Booklet</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>Features &raquo;</li>
        
      
    
    <li>Location</li>
    <li class="wy-breadcrumbs-aside">
      
        
          <a href="https://github.com/owntracks" class="icon icon-github"> Edit on GitHub</a>
        
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <p>Location data is obtained by your smartphone and published to the <a href="../../guide/broker/">MQTT broker</a> as follows:</p>
<h3 id="android">Android</h3>
<p>The way it currently works is by specifying an interval in which you want to receive updates (the one you configure in the settings). You only receive updates if this amount of time has passed and you moved more than 500m (when the app is in the background. The movement restriction is set to 50m or so when in the foreground).</p>
<p>Say I set an interval of 10min and I don't move; will I get a PUBlish? No. 
If you move more than 500 meters in 5 minutes you'll get a PUB after 10 minutes. You won't get a PUB after 5 minutes though.</p>
<p>Additional restrictions apply regarding the update intervall. When switching into the background or foreground, a new location request is setup with a different granularity and energy requirement. As a result, a new location is received immedeately by the app. </p>
<p>Thus, when the app goes into the background, a new location is received. Most likely, this will not result in a publish as the last publish was not longer ago than 10 minutes. Say the last update was exactly 9 minutes ago when the background mode is enabled. In this case no publish will be sent. However, the next location will probably only be received after the specified 10 minutes. At this point, the time of the last publish is longer than 10 minutes ago. So in this worst case, around 20 will pass before a location will be sent. </p>
<p>If you switch on the app after one minute in the background (11 minutes after the last publish), a new report will be sent immediately as soon as a new location is available. </p>
<h3 id="ios">iOS</h3>
<p>The iOS app offers 3 modes of location publication:</p>
<ul>
<li><em>Manual</em> mode</li>
<li><em>Significant location change</em> mode</li>
<li><em>Move</em> mode</li>
</ul>
<p>In addition to this, there's also <em>Region Monitoring</em> (a.k.a. Geo Fence) and <em>iBeacon Monitoring</em> and <em>iBeacon Ranging</em>.</p>
<h4 id="move-mode">MOVE mode</h4>
<p>In MOVE mode, the app monitors location permanently and publishes a new
location as soon as the device moves <code>x</code> meters or after <code>t</code> seconds, whatever
happens first. <code>x</code> and <code>t</code> can be adjusted by the user in the systems settings for
OwnTracks. The defaults are 100m and 300 seconds (5 minutes). </p>
<p>The payoff is higher battery usage as high as in navigation or tracker app.
So it is recommend to use MOVE mode while charging or during moves only - hence the name.</p>
<p>Please note, MOVE mode is active when the app is active (a.k.a in foreground).</p>
<h4 id="significant-location-change-mode">SIGNIFICANT LOCATION CHANGE mode</h4>
<p>iOS defines a SIGNIFICANT LOCATION CHANGE as travelling a distance of at least
500 meters in 5 minutes.  This mode allows the app to run in background and
minimize the power consumption.</p>
<p>This standard tracking mode reports significant location changes only (&gt;500m
and at most once every 5 minutes).  This is defined by Apple and is optimal
with respect to battery usage.</p>
<p>Examples:</p>
<ul>
<li>if you don't move, no new location is published - even if you don't move for hours</li>
<li>if you move at least 500 meters, a new location will be published after 5 minutes</li>
<li>if you move 10 kilometers in 5 minutes, only one location will be published</li>
</ul>
<h4 id="manual-mode">MANUAL mode</h4>
<p>The app doesn't monitor location changes in MANUAL mode while in background.
The user has to publish the current location explicitly via the UI.</p>
<h4 id="region-monitoring">REGION monitoring</h4>
<p>The app user may mark a previously manually published or manually created 
location as a monitored circular region by specifying a monitoring radius in meters.
The app will publish the location
additionally everytime the device leaves or enters one of the regions, and the
published data contains an indication of whether the device is entering or
leaving the region.</p>
<p>Region monitoring is not related to one of the location publication modes and
works independently. It is switched on when a region is setup with description
and radius. To switch region monitoring off, all regions have to be 
unmarked (by setting radius to 0).</p>
<p>Regions are shown on the map display in transparent blue or red circles. Red
indicates the device is is within the region.</p>
<h4 id="ibeacon-monitoring">iBeacon monitoring</h4>
<p>The app user may mark a previously manually published or manually created location
as a monitored beacon region by appending a beacon uuid to the region's name.
The app will publish the location
additionally everytime the device leaves or enters one of the beacon regions, and the
published data contains an indication of whether the device is entering or
leaving the region.</p>
<p>Region monitoring is not related to one of the location publication modes and
works independently. It is switched on when a region's name has a valid uuid
appended.</p>
<p>If the device is within a monitored beacon region, the the beacon indicator
is shown in red, otherwise blue meaning device is not in any iBeacon region.</p>
<p>There are 2 kinds of locations:
a) an <code>automatic location</code> created when iOS detects a change of location
b) a <code>manual location</code> created by the user</p>
<p>A <code>manual location</code> with a non-zero length remark (description) is a <code>waypoint</code>.</p>
<p>If a <code>waypoint</code> is <code>shared</code>, its attributes are published when created or changed.</p>
<p>If a <code>waypoint</code> specifies a radius, a <code>circular region</code> is monitored for <code>enter/leave events</code>.</p>
<p>If a <code>waypoint</code> is not a <code>circular region</code> and the <code>waypoint</code>'s description contains a valid <code>iBeacon</code> specification, a <code>beacon region</code> is monitored for <code>enter/leave events</code>.</p>
<p>If an <code>enter/leave event</code> occurs an event message is published with the <code>type</code> attribute set to <code>c</code>or <code>b</code>for (<code>circular region</code>or <code>beacon region</code>). The message contains an <code>event</code>attribute specifying either <code>enter</code>or <code>leave</code>.</p>
<p>If the <code>waypoint</code>is <code>shared</code>, the description of the <code>waypoint</code>is added to the published <code>event</code>message.</p>
<table>
<thead>
<tr>
<th>Automatic</th>
<th>Description</th>
<th>iBeacon</th>
<th>Radius</th>
<th>Shared</th>
<th>Event Message</th>
<th>/w Description</th>
<th>Waypoint Message</th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Y</td>
<td>n/a</td>
<td>n/a</td>
<td>n/a</td>
<td>n/a</td>
<td>N</td>
<td>N</td>
<td>N</td>
<td></td>
<td></td>
</tr>
<tr>
<td>N</td>
<td>N</td>
<td>n/a</td>
<td>n/a</td>
<td>n/a</td>
<td>N</td>
<td>N</td>
<td>N</td>
<td></td>
<td></td>
</tr>
<tr>
<td>N</td>
<td>Y</td>
<td>N</td>
<td>N</td>
<td>N</td>
<td>N</td>
<td>N</td>
<td>N</td>
<td></td>
<td></td>
</tr>
<tr>
<td>N</td>
<td>Y</td>
<td>N</td>
<td>N</td>
<td>Y</td>
<td>N</td>
<td>N</td>
<td>Y</td>
<td></td>
<td></td>
</tr>
<tr>
<td>N</td>
<td>Y</td>
<td>N</td>
<td>Y</td>
<td>N</td>
<td><code>c</code></td>
<td>N</td>
<td>N</td>
<td></td>
<td></td>
</tr>
<tr>
<td>N</td>
<td>Y</td>
<td>N</td>
<td>Y</td>
<td>Y</td>
<td><code>c</code></td>
<td>Y</td>
<td>Y</td>
<td></td>
<td></td>
</tr>
<tr>
<td>N</td>
<td>Y</td>
<td>Y</td>
<td>N</td>
<td>N</td>
<td><code>b</code></td>
<td>N</td>
<td>N</td>
<td></td>
<td></td>
</tr>
<tr>
<td>N</td>
<td>Y</td>
<td>Y</td>
<td>N</td>
<td>Y</td>
<td><code>b</code></td>
<td>Y</td>
<td>Y</td>
<td></td>
<td></td>
</tr>
<tr>
<td>N</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>N</td>
<td><code>c</code></td>
<td>N</td>
<td>N</td>
<td></td>
<td></td>
</tr>
<tr>
<td>N</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td><code>c</code></td>
<td>Y</td>
<td>Y</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../tid/" class="btn btn-neutral float-right" title="TID"/>Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../tls/" class="btn btn-neutral" title="TLS"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
    <!-- Copyright etc -->
    </p>
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
	  
        </div>
      </div>

    </section>

  </div>

<div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a class="icon icon-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="../tls/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../tid/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>

</body>
</html>
